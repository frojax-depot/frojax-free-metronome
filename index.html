<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FROJAX FREE CLICK</title>
<style>
  body {
    margin: 0;
    background: #000;
    color: #fff;
    font-family: Arial, sans-serif;
    text-align: center;
  }

  .app {
    height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    transition: background 0.3s ease;
  }

  .app.trainer-on {
    background: radial-gradient(circle at center, #222 0%, #000 100%);
  }

  .brand {
    font-size: 22px;
    font-weight: 900;
    color: gold;
    margin-bottom: 30px;
    text-transform: uppercase;
  }

  .controls {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .btn {
    background: #222;
    color: #fff;
    border: 2px solid gold;
    border-radius: 12px;
    font-size: 18px;
    padding: 12px 24px;
    cursor: pointer;
    transition: all 0.2s;
  }

  .btn:hover {
    background: gold;
    color: black;
  }

  .trainer-panel {
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .trainer-panel label {
    font-size: 16px;
  }

  .trainer-panel input {
    width: 80px;
    text-align: center;
    margin-left: 8px;
  }

  .trainer-panel[aria-disabled="true"] {
    opacity: 0.4;
    pointer-events: none;
  }

  .status {
    margin-top: 20px;
    font-size: 16px;
    opacity: 0.8;
  }
</style>
</head>

<body>
  <div id="app" class="app">
    <header class="brand">FROJAX FREE CLICK</header>

    <div class="controls">
      <button id="trainerToggle" class="btn" aria-pressed="false" title="Toggle Trainer Mode">
        üèãÔ∏è Trainer: OFF
      </button>

      <button id="startStop" class="btn" aria-pressed="false">
        ‚ñ∂ Start
      </button>
    </div>

    <section id="trainerPanel" class="trainer-panel" aria-disabled="true">
      <label>Start BPM <input id="trainerStartBpm" type="number" min="20" max="300" value="60" disabled></label>
      <label>End BPM <input id="trainerEndBpm" type="number" min="20" max="300" value="100" disabled></label>
      <label>Duration (min) <input id="trainerDurationMin" type="number" min="1" max="60" value="5" disabled></label>
    </section>

    <div id="status" class="status">Idle</div>
  </div>

<script>
  // --- State ---
  let isTrainerOn = false;
  let isRunning = false;
  let trainingTimer = null;
  let currentBpm = 80;

  // --- Elements ---
  const app = document.getElementById('app');
  const trainerToggle = document.getElementById('trainerToggle');
  const trainerPanel = document.getElementById('trainerPanel');
  const startStopBtn = document.getElementById('startStop');
  const statusEl = document.getElementById('status');
  const startBpmInput = document.getElementById('trainerStartBpm');
  const endBpmInput = document.getElementById('trainerEndBpm');
  const durMinInput = document.getElementById('trainerDurationMin');

  // --- Placeholder sound (simple click) ---
  let clickInterval;

  function playClick(bpm) {
    clearInterval(clickInterval);
    const interval = 60000 / bpm;
    clickInterval = setInterval(() => {
      const osc = new AudioContext();
      const beep = osc.createOscillator();
      beep.connect(osc.destination);
      beep.start();
      beep.stop(osc.currentTime + 0.05);
    }, interval);
  }

  function stopClick() {
    clearInterval(clickInterval);
  }

  function metronomeStart(bpm) {
    playClick(bpm);
    statusEl.textContent = `Running @ ${bpm} BPM`;
  }

  function metronomeStop() {
    stopClick();
    statusEl.textContent = 'Stopped';
  }

  function setBpm(bpm) {
    playClick(bpm);
  }

  // --- Trainer toggle ---
  trainerToggle.addEventListener('click', () => {
    isTrainerOn = !isTrainerOn;
    trainerToggle.setAttribute('aria-pressed', String(isTrainerOn));
    trainerToggle.textContent = isTrainerOn ? 'üèãÔ∏è Trainer: ON' : 'üèãÔ∏è Trainer: OFF';
    app.classList.toggle('trainer-on', isTrainerOn);

    const disabled = !isTrainerOn;
    trainerPanel.setAttribute('aria-disabled', String(disabled));
    startBpmInput.disabled = disabled;
    endBpmInput.disabled = disabled;
    durMinInput.disabled = disabled;

    statusEl.textContent = isTrainerOn ? 'Trainer enabled. Configure your ramp.' : 'Trainer disabled.';
  });

  // --- Start/Stop ---
  startStopBtn.addEventListener('click', () => {
    if (!isRunning) {
      isRunning = true;
      startStopBtn.textContent = '‚ñ† Stop';
      startStopBtn.setAttribute('aria-pressed', 'true');

      if (isTrainerOn) {
        startTrainingRun();
      } else {
        metronomeStart(currentBpm);
      }
    } else {
      stopAll();
    }
  });

  function stopAll() {
    isRunning = false;
    startStopBtn.textContent = '‚ñ∂ Start';
    startStopBtn.setAttribute('aria-pressed', 'false');
    clearTrainingTimer();
    metronomeStop();
  }

  // --- Training ramp ---
  function startTrainingRun() {
    const startBpm = clamp(+startBpmInput.value || 60, 20, 300);
    const endBpm = clamp(+endBpmInput.value || 100, 20, 300);
    const minutes = Math.max(1, +durMinInput.value || 5);

    metronomeStart(startBpm);
    const totalMs = minutes * 60 * 1000;
    const t0 = performance.now();

    clearTrainingTimer();

    trainingTimer = requestAnimationFrame(function step(now) {
      if (!isRunning) return;
      const elapsed = now - t0;
      const p = Math.min(1, elapsed / totalMs);
      const bpm = Math.round(lerp(startBpm, endBpm, p));

      if (bpm !== currentBpm) {
        setBpm(bpm);
        currentBpm = bpm;
        statusEl.textContent = `Training: ${bpm} BPM (${startBpm}‚Üí${endBpm})`;
      }

      if (p < 1) {
        trainingTimer = requestAnimationFrame(step);
      } else {
        statusEl.textContent = `Training done @ ${endBpm} BPM`;
        isRunning = false;
        startStopBtn.textContent = '‚ñ∂ Start';
      }
    });
  }

  function clearTrainingTimer() {
    if (trainingTimer) {
      cancelAnimationFrame(trainingTimer);
      trainingTimer = null;
    }
  }

  // --- Helpers ---
  function lerp(a, b, t) { return a + (b - a) * t; }
  function clamp(v, mn, mx) { return Math.min(mx, Math.max(mn, v)); }
</script>
</body>
</html>
